let t=0;class e{Id;Element;constructor(t){null!=t&&(this.Id=t,this.Element=document.getElementById(t))}addEventListener(t,e){this.Element.addEventListener(t,e)}static GenerateId(){return"comp-"+ ++t}}class n extends e{constructor(t){super(t),function(t){const e=document.createElement("div"),n=document.createElement("input");n.setAttribute("type","hidden"),n.classList.add("fgta5-entry-lastvalue"),e.classList.add("fgta5-entry-container"),t.Element.getInputCaption=()=>t.Id,t.Nodes={Input:t.Element,Container:e,LastValue:n}}(this),function(t){var e=t.Nodes.Input.getAttribute("invalid-message"),n=t.Nodes.Input.getAttribute("required");if(null!=n&&"false"!==n.toLowerCase()){var r=window.$validators.getInvalidMessage("required",t.Nodes.Input,e);t.AddValidator("required",null,r)}var a=t.Nodes.Input.getAttribute("minlength");if(null!=a&&(a=parseInt(a),!isNaN(a))){r=window.$validators.getInvalidMessage("minlength",t.Nodes.Input,e);t.AddValidator("minlength",a,r)}var i=t.Nodes.Input.getAttribute("maxlength");if(null!=i&&(i=parseInt(i),!isNaN(i))){r=window.$validators.getInvalidMessage("maxlength",t.Nodes.Input,e);t.AddValidator("maxlength",i,r)}var s=t.Nodes.Input.getAttribute("pattern");if(null!=s&&""!==s.trim()){r=window.$validators.getInvalidMessage("pattern",t.Nodes.Input,e);t.AddValidator("pattern",s,r)}var o=t.Nodes.Input.getAttribute("min");if(null!=o&&(o=parseInt(o),!isNaN(o))){r=window.$validators.getInvalidMessage("min",t.Nodes.Input,e);t.AddValidator("min",o,r)}var d=t.Nodes.Input.getAttribute("max");if(null!=d&&(d=parseInt(d),!isNaN(d))){r=window.$validators.getInvalidMessage("max",t.Nodes.Input,e);t.AddValidator("max",d,r)}var l=t.Nodes.Input.getAttribute("validator");if(null!=l&&""!==l.trim()){l=l.split(",");for(var u=0;u<l.length;u++){var c=l[u].trim(),{fnName:p,fnParams:m}=$fgta5.Validators.parseFunctionParam(c);r=window.$validators.getInvalidMessage("pattern",t.Nodes.Input,e);t.AddValidator(p,m,r)}}}(this)}get Type(){return this.constructor.name}get Value(){return this.Element.value}set Value(t){this.Element.value=t}get Disabled(){return this.Element.disabled}set Disabled(t){this.Element.disabled=t}#t;get Form(){return this.#t}bindForm(t){this.#t=t}#e=!0;get InEditMode(){return this.#e}SetEditingMode(t){this.#e=t}NewData(t){!function(t,e){null==e?e="":"string"!=typeof e&&(e=String(e));t.Value=e,t._setLastValue(t.Value),t.SetError(null)}(this,t)}AcceptChanges(){var t;(t=this)._setLastValue(t.Value),t.Nodes.Input.removeAttribute("changed"),t.SetError(null)}Reset(){var t;(t=this).Value=t.GetLastValue(),t.Nodes.Input.removeAttribute("changed"),t.SetError(null)}IsChanged(){return(t=this).GetLastValue()!=t.Value;var t}SetError(t){!function(t,e){var n=t.Nodes.Container.querySelector(".fgta5-entry-error");null!==e&&""!==e?(t.Nodes.Input.setAttribute("invalid","true"),n||((n=document.createElement("div")).classList.add("fgta5-entry-error"),t.Nodes.Container.insertBefore(n,t.Nodes.InputWrapper.nextSibling)),n.innerHTML=e):(t.Nodes.Input.removeAttribute("invalid"),n&&n.remove())}(this,t)}_setLastValue(t){!function(t,e){t.Nodes.LastValue.value=e}(this,t)}GetLastValue(){return this.Nodes.LastValue.value}GetBindingData(){var t=this.Element.getAttribute("binding");return null===t?null:t}Validate(){return function(t){for(const[r,a]of Object.entries(t.Validators)){const i=$validators[r],s=a.param,o=a.message;try{if("function"!=typeof i)throw e=new Error(`Validator function '${r}' is not defined or not a function`);if(!i(t.Value,s)){var e=new Error(`Invalid value '${t.Value}' for '${t.Nodes.Input.getInputCaption()}' using validator '${r}(${s??""})'`),n=o;throw null!==n&&""!==n||(n=e.message),new Error(n)}}catch(e){return t.SetError(e.message),!1}}return!0}(this)}#n={};get Validators(){return this.#n}AddValidator(t,e,n){this.#n[t]={param:e,message:n}}RemoveValidator(t){void 0!==this.#n[t]&&delete this.#n[t]}}class r extends n{constructor(t){super(t),function(t,e){const n=t.Nodes.Container,r=t.Nodes.LastValue,a=t.Nodes.Input,i=document.createElement("div"),s=document.querySelector(`label[for="${e}"]`);a.classList.add("fgta5-entry-input"),a.parentNode.insertBefore(n,a),i.classList.add("fgta5-entry-input-wrapper"),i.appendChild(a),n.appendChild(i),n.appendChild(r),""!==a.style.backgroundColor&&(i.style.backgroundColor=a.style.backgroundColor,a.style.backgroundColor="transparent");var o=t.Element.getAttribute("character-case");null!==o&&""!==o.trim()&&(a.charCase=o.trim().toLowerCase());t._setLastValue(a.value);var d=t.Element.getAttribute("description");if(null!==d&&""!==d.trim()){d=d.trim();const t=document.createElement("div");t.classList.add("fgta5-entry-description"),t.innerHTML=d,n.appendChild(t)}a.addEventListener("input",(function(e){t.GetLastValue()!=a.value?a.setAttribute("changed","true"):a.removeAttribute("changed")})),a.addEventListener("blur",(function(e){!function(t){t.InEditMode&&(t.SetError(null),t.Validate())}(t)})),t.Nodes.InputWrapper=i,t.Nodes.Label=s,t.Nodes.Input.getInputCaption=()=>s.innerHTML}(this,t)}get Value(){return function(t){var e=t.Nodes.Input,n=e.value;"uppercase"===e.charCase?n=n.toUpperCase():"lowercase"===e.charCase&&(n=n.toLowerCase());return n}(this)}#e=!0;get InEditMode(){return this.#e}SetEditingMode(t){this.#e=t,function(t,e){var n=e?"true":"false";t.Nodes.Input.setAttribute("editmode",n),t.Nodes.InputWrapper.setAttribute("editmode",n),e?t.Nodes.Input.removeAttribute("readonly"):(t.Nodes.Input.setAttribute("readonly","true"),t.SetError(null))}(this,t)}}class a extends n{constructor(t){super(t),this.formatterFixed=new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}),function(t,e){const n=t.Nodes.Container,r=t.Nodes.LastValue,a=t.Nodes.Input,i=document.createElement("div"),s=document.createElement("input"),o=document.querySelector(`label[for="${e}"]`);a.classList.add("fgta5-entry-input"),a.parentNode.insertBefore(n,a),a.setAttribute("type","hidden"),i.classList.add("fgta5-entry-input-wrapper"),s.classList.add("fgta5-entry-display"),i.appendChild(s),i.appendChild(a),n.appendChild(i),n.appendChild(r);var d=t.Element.getAttribute("description");if(null!==d&&""!==d.trim()){d=d.trim();const t=document.createElement("div");t.classList.add("fgta5-entry-description"),t.innerHTML=d,n.appendChild(t)}var l=t.Element.getAttribute("precision");null!==l&&""!==l.trim()?(l=parseInt(l.trim()),(isNaN(l)||l<0)&&(l=0),s.setAttribute("precision",l)):(l=0,s.setAttribute("precision",l));a.precision=l,t.formatterFixed.minimumFractionDigits=l,t.formatterFixed.maximumFractionDigits=l,(null===a.value||""===a.value)&&(a.value="0");t._setLastValue(a.value),s.value=t.formatterFixed.format(a.value),s.id=t.Id+"-display",s.min=a.min,s.max=a.max,s.minlength=a.minlength,s.maxlength=a.maxlength,s.required=a.required,s.setAttribute("style",a.getAttribute("style")||""),s.setAttribute("type","text"),s.setAttribute("fgta5-component","Numberbox"),o.setAttribute("for",s.id),s.addEventListener("focus",(function(e){!function(t){var e=t.Nodes.Display,n=t.Nodes.Input;if(t.InEditMode){e.setAttribute("type","number");var r=Number(n.value);e.value=r}}(t)})),s.addEventListener("blur",(function(e){!function(t){var e=t.Nodes.Display,n=t.Nodes.Input;if(t.InEditMode){var r=Number(e.value);if(isNaN(r))t.SetError("Invalid number");else{t.SetError(null),n.value=r,t.Validate();var a=t.formatterFixed.format(r);e.setAttribute("type","text"),e.value=a}}}(t)})),s.addEventListener("input",(function(t){s.value!==r.value?s.setAttribute("changed","true"):s.removeAttribute("changed")})),t.Nodes.InputWrapper=i,t.Nodes.Label=o,t.Nodes.Display=s,t.Nodes.Input.getInputCaption=()=>o.innerHTML}(this,t)}get Value(){return this.Element.value}set Value(t){var e,n,r;this.Element.value=t,e=this,n=Number(e.Nodes.Input.value),r=e.formatterFixed.format(n),"text"===e.Nodes.Display.type?e.Nodes.Display.value=r:e.Nodes.Display.value=n}get Disabled(){return this.Element.disabled}set Disabled(t){this.Element.disabled=t,function(t,e){t.Nodes.Display.disabled=!!e}(this,t)}#e=!0;get InEditMode(){return this.#e}SetEditingMode(t){this.#e=t,function(t,e){var n=e?"true":"false";t.Nodes.Display.setAttribute("editmode",n),t.Nodes.Input.setAttribute("editmode",n),t.Nodes.InputWrapper.setAttribute("editmode",n),e?(t.Nodes.Input.removeAttribute("readonly"),t.Nodes.Display.removeAttribute("readonly")):(t.Nodes.Input.setAttribute("readonly","true"),t.Nodes.Display.setAttribute("readonly","true"),t.SetError(null))}(this,t)}AcceptChanges(){super.AcceptChanges(),this.Nodes.Display.removeAttribute("changed")}Reset(){super.Reset(),this.Nodes.Display.removeAttribute("changed")}SetError(t){super.SetError(t),function(t,e){null!==e&&""!==e?t.Nodes.Display.setAttribute("invalid","true"):t.Nodes.Display.removeAttribute("invalid")}(this,t)}addEventListener(t,e){this.Nodes.Display.addEventListener(t,e)}}class i extends n{constructor(t){super(t),function(t,e){t.Nodes.Container,t.Nodes.Input,document.querySelector(`label[for="${e}"]`)}(this,t)}}const s=new CustomEvent("locked"),o=new CustomEvent("unlocked");function d(t,e){var n=t.Element,r=!e;for(var a in t.Inputs){t.Inputs[a].SetEditingMode(r)}return e?(n.dispatchEvent(s),n.setAttribute("locked",e)):(n.dispatchEvent(o),n.removeAttribute("locked")),e}const l={info:"fgta5-icon-info",warning:"fgta5-icon-warning",error:"fgta5-icon-error",question:"fgta5-icon-question"};class u{Text="button";constructor(t){this.Text=t}}class c{static ButtonOkCancel=Object.freeze({ok:new u("Ok"),cancel:new u("Cancel")});static ButtonYesNo=Object.freeze({yes:new u("Yes"),no:new u("No")});static ButtonYesNoCancel=Object.freeze({yes:new u("Yes"),no:new u("No"),cancel:new u("Cancel")});static async Show(t,e){return await p(t,e)}static async Error(t){return await async function(t){return await p(t,{iconcss:"error"})}(t)}static async Info(t){return await async function(t){return await p(t,{iconcss:"info"})}(t)}static async Warning(t){return await async function(t){return await p(t,{iconcss:"warning"})}(t)}static async Confirm(t,e){return await async function(t,e){return e=void 0===e?c.ButtonOkCancel:e,await p(t,{iconcss:"question",buttons:e})}(t,e)}}async function p(t,e){void 0===e&&(e={});var n=function(t,e){const n=document.createElement("dialog");if(n.classList.add("fgta5-messagebox-dialog"),n.addEventListener("close",(t=>{n.parentNode.removeChild(n)})),e.title&&(n.divTitle=document.createElement("div"),n.divTitle.classList.add("fgta5-messagebox-title"),n.divTitle.innerHTML=e.title,n.appendChild(n.divTitle)),e.iconcss){var r=l[e.iconcss]?l[e.iconcss]:e.iconcss;n.divIcon=document.createElement("div"),n.divIcon.classList.add("fgta5-messagebox-icon"),n.divIcon.classList.add(r),n.appendChild(n.divIcon)}return n.divContent=document.createElement("div"),n.divContent.classList.add("fgta5-messagebox-content"),n.divContent.innerHTML=t,n.appendChild(n.divContent),n.divButtons=document.createElement("div"),n.divButtons.classList.add("fgta5-messagebox-buttonsbar"),n.appendChild(n.divButtons),document.body.appendChild(n),n}(t,e);return new Promise((t=>{if(e.buttons)for(const[r,a]of Object.entries(e.buttons)){const e=document.createElement("button");e.classList.add("fgta5-messagebox-button"),e.innerHTML=a.Text,e.addEventListener("click",(()=>{n.close(),t(r)})),n.divButtons.appendChild(e)}else{const e=document.createElement("button");e.classList.add("fgta5-messagebox-button"),e.innerHTML="Ok",e.addEventListener("click",(()=>{n.close(),t("ok")})),n.divButtons.appendChild(e)}n.showModal()}))}function m(){const t=document.createElement("dialog");return t.classList.add("fgta5-modal-message"),t.addEventListener("close",(e=>{t.parentNode.removeChild(t)})),document.body.appendChild(t),t.showModal(),t}var v=Object.freeze({__proto__:null,getInvalidMessage:function(t,e,n){var r=e.getAttribute(`invalid-message-${t}`);return null!=r&&""!==r||(r=n),r},parseFunctionParam:function(t){const[e,...n]=t.split(":"),r=n.length>0?n.join(":"):null;return{fnName:e,fnParams:null!==r?isNaN(r)?r:Number(r):null}},required:function(t){return null!=t&&""!==t},minlength:function(t,e){return null==e||0===e||!(null==t||t.length<e)},maxlength:function(t,e){return null==e||0===e||!(null==t||t.length>e)},pattern:function(t,e){return!0},email:function(t,e){return/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(t)},min:function(t,e){return null==e||0===e||!(null==t||t<e)},max:function(t,e){return null==e||0===e||!(null==t||t>e)}});const f={Component:e,Form:class extends e{#r=!1;Inputs={};constructor(t){super(t),this.#a(),function(t,e){var n=document.getElementById(e);t.Id=e,t.Element=n,t.Inputs={},t.Element.addEventListener("submit",(t=>{t.preventDefault()}));for(var s=n.querySelectorAll("input"),o=0;o<s.length;o++){var d=s[o],l=d.getAttribute("fgta5-component");null!=l&&null!=d.id&&""!=d.id&&("Textbox"==l?t.Inputs[d.id]=new r(d.id):"Numberbox"==l?t.Inputs[d.id]=new a(d.id):"Datepicker"==l||"Combobox"==l||"Checkbox"==l&&(t.Inputs[d.id]=new i(d.id)))}}(this,t)}Lock(t){this.#r=d(this,t)}IsLocked(){return this.#r}Reset(){!function(t){for(var e in t.Inputs){t.Inputs[e].Reset()}}(this)}AcceptChanges(){!function(t){for(var e in t.Inputs){t.Inputs[e].AcceptChanges()}}(this)}IsChanged(){return function(t){for(var e in t.Inputs){if(t.Inputs[e].IsChanged())return!0}return!1}(this)}NewData(t){!function(t,e){for(var n in t.Inputs){var r=t.Inputs[n],a=e[r.GetBindingData()];r.NewData(a)}}(this,t)}Render(){!function(t){for(var e in t.Inputs){t.Inputs[e].bindForm(t)}t.IsLocked()?d(t,!0):d(t,!1)}(this)}Validate(){return function(t){var e=!0;for(var n in t.Inputs){var r=t.Inputs[n];e&&=r.Validate()}return e}(this)}GetData(){return function(t){var e={};for(var n in t.Inputs){var r=t.Inputs[n],a=r.GetBindingData();a&&(e[a]=r.Value)}return e}(this)}#a(){var t=this.Element.getAttribute("locked");null==t&&(t="false"),"true"===t.toLowerCase()?this.#r=!0:this.#r=!1}},Button:class extends e{constructor(t){var e;super(t),(e=this).Element.classList.add("fgta5-button"),e.Element.setAttribute("type","button")}#i=!1;get Disabled(){return this.#i}set Disabled(t){var e;this.#i=t,e=t,this.Element.disabled=e}},Textbox:r,Numberbox:a,Checkbox:i,MessageBox:c,MessageBoxButton:u,Modal:class{static Show(t){return m()}static Mask(t){return function(t){t=void 0===t?"Please wait ...":t;const e=m();var n=document.createElement("div");n.classList.add("fgta5-modal-loadermask-msg"),e.appendChild(n);var r=document.createElement("div");r.classList.add("fgta5-modal-loadermask-msg-icon"),r.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 200 200"><radialGradient id="a11" cx=".66" fx=".66" cy=".3125" fy=".3125" gradientTransform="scale(1.5)"><stop offset="0" stop-color="#575757"></stop><stop offset=".3" stop-color="#575757" stop-opacity=".9"></stop><stop offset=".6" stop-color="#575757" stop-opacity=".6"></stop><stop offset=".8" stop-color="#575757" stop-opacity=".3"></stop><stop offset="1" stop-color="#575757" stop-opacity="0"></stop></radialGradient><circle transform-origin="center" fill="none" stroke="url(#a11)" stroke-width="30" stroke-linecap="round" stroke-dasharray="200 1000" stroke-dashoffset="0" cx="100" cy="100" r="70"><animateTransform type="rotate" attributeName="transform" calcMode="spline" dur="1.8" values="360;0" keyTimes="0;1" keySplines="0 0 1 1" repeatCount="indefinite"></animateTransform></circle><circle transform-origin="center" fill="none" opacity=".2" stroke="#575757" stroke-width="30" stroke-linecap="round" cx="100" cy="100" r="70"></circle></svg>',n.appendChild(r);var a=document.createElement("div");return a.classList.add("fgta5-modal-loadermask-msg-text"),a.innerHTML=t,n.appendChild(a),e.setText=t=>{a.innerHTML=t},e}(t)}static Progress(t){return function(t){void 0===t&&(t={});const e=m();e.IsError=!1;var n=document.createElement("div");e.appendChild(n);var r=document.createElement("div");r.classList.add("fgta5-modal-progressbar-container"),e.appendChild(r);var a=document.createElement("label");a.classList.add("fgta5-modal-progressbar"),r.appendChild(a);var i=document.createElement("div");return i.classList.add("fgta5-modal-progressbar-text"),e.appendChild(i),e.setProgress=function(t,e){t>100&&(t=100),a.innerHTML=`${t}%`,a.style.width=`${t}%`,i.innerHTML=e},e.setError=function(t){e.IsError=!0,n.classList.add("fgta5-icon-error"),n.style.height="32px",n.style.marginBottom="10px",i.innerHTML=t,i.setAttribute("error","true"),a.setAttribute("error","true")},e.finish=function(n,r){if(void 0===n&&(n="Done"),void 0===r&&(r=!0),!0===t.buttonClose||e.IsError){r&&(i.style.display="none",a.style.width="100%",a.innerHTML="100%");var s=document.createElement("div");s.style.textAlign="center",s.style.marginTop="10px",s.style.marginBottom="0";var o=document.createElement("button");o.classList.add("fgta5-modal-button"),o.innerHTML=n,o.addEventListener("click",(()=>{e.close()})),s.appendChild(o),e.appendChild(s)}else e.close()},e}(t)}}};void 0===window.$validators?window.$validators=v:Object.assign(window.$validators,v);export{f as default};
