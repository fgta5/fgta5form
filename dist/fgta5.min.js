let t=0;class e{Id;Element;constructor(t){null!=t&&(this.Id=t,this.Element=document.getElementById(t))}addEventListener(t,e){this.Element.addEventListener(t,e)}static GenerateId(){return"comp-"+ ++t}}class n extends e{constructor(t){super(t),function(t){const e=document.createElement("div"),n=document.createElement("input");n.setAttribute("type","hidden"),n.classList.add("fgta5-entry-lastvalue"),e.classList.add("fgta5-entry-container"),t.Nodes={Input:t.Element,Container:e,LastValue:n}}(this)}get Type(){return this.constructor.name}get Value(){return this.Element.value}set Value(t){this.Element.value=t}get Disabled(){return this.Element.disabled}set Disabled(t){this.Element.disabled=t}#t;get Form(){return this.#t}bindForm(t){this.#t=t}#e=!0;get InEditMode(){return this.#e}SetEditingMode(t){this.#e=t}NewData(){}AcceptChanges(){}Reset(){}IsChanged(){return!1}SetError(t){!function(t,e){var n=t.Nodes.Container.querySelector(".fgta5-entry-error");null!==e&&""!==e?(t.Element.setAttribute("invalid","true"),n||((n=document.createElement("div")).classList.add("fgta5-entry-error"),t.Nodes.Container.insertBefore(n,t.Nodes.InputWrapper.nextSibling)),n.innerHTML=e):(t.Element.removeAttribute("invalid"),n&&n.remove())}(this,t)}GetLastValue(){}GetBindingName(){var t=this.Element.getAttribute("binding");return null===t?null:t}Validate(){return!0}#n={};get Validators(){return this.#n}AddValidator(t,e){this.#n[t]=e}RemoveValidator(t){void 0!==this.#n[t]&&delete this.#n[t]}}class r extends n{constructor(t){super(t),function(t){const e=t.Nodes.Container,n=t.Nodes.LastValue,r=t.Nodes.Input,i=document.createElement("div"),a=document.querySelector(`label[for="${t.Id}"]`);r.classList.add("fgta5-entry-input"),r.parentNode.insertBefore(e,r),i.classList.add("fgta5-entry-input-wrapper"),i.appendChild(r),e.appendChild(i),e.appendChild(n),""!==r.style.backgroundColor&&(i.style.backgroundColor=r.style.backgroundColor,r.style.backgroundColor="transparent");n.value=r.value;var s=t.Element.getAttribute("description");if(null!==s&&""!==s.trim()){s=s.trim();const t=document.createElement("div");t.classList.add("fgta5-entry-description"),t.innerHTML=s,e.appendChild(t)}r.addEventListener("input",(function(e){t.Nodes.LastValue.value!=r.value?r.setAttribute("changed","true"):r.removeAttribute("changed")})),t.Nodes.InputWrapper=i,t.Nodes.Label=a}(this),function(t){var e=t.Element.getAttribute("required");null!=e&&"false"!==e.toLowerCase()&&t.AddValidator("required");var n=t.Element.getAttribute("minlength");null!=n&&(n=parseInt(n),isNaN(n)||t.AddValidator("minlength",n));var r=t.Element.getAttribute("maxlength");null!=r&&(r=parseInt(r),isNaN(r)||t.AddValidator("maxlength",r));var i=t.Element.getAttribute("pattern");null!=i&&""!==i.trim()&&t.AddValidator("pattern",i);var a=t.Element.getAttribute("validator");if(null!=a&&""!==a.trim()){a=a.split(",");for(var s=0;s<a.length;s++){var o=a[s].trim(),{fnName:d,fnParams:l}=$fgta5.Validators.parseFunctionParam(o);t.AddValidator(d,l)}}}(this)}#e=!0;get InEditMode(){return this.#e}SetEditingMode(t){this.#e=t,function(t,e){var n=e?"true":"false";t.Nodes.Input.setAttribute("editmode",n),t.Nodes.InputWrapper.setAttribute("editmode",n),e?t.Element.removeAttribute("readonly"):(t.Element.setAttribute("readonly","true"),t.SetError(null))}(this,t)}NewData(t){!function(t,e){null==e?e="":"string"!=typeof e&&(e=String(e));t.Value=e,t.Nodes.LastValue.value=e,t.SetError(null)}(this,t)}AcceptChanges(){var t;(t=this).Nodes.LastValue.value=t.Value,t.Element.removeAttribute("changed"),t.SetError(null)}Reset(){var t;(t=this).Value=t.Nodes.LastValue.value,t.Element.removeAttribute("changed"),t.SetError(null)}IsChanged(){return(t=this).Nodes.LastValue.value!=t.Value;var t}Validate(){return function(t){for(const[i,a]of Object.entries(t.Validators)){var e=$validators[i];try{if("function"!=typeof e)throw n=new Error(`Validator function '${i}' is not defined or not a function`);if(!e(t.Value,a)){var n=new Error(`Invalid value '${t.Value}' for '${t.Id}' using validator '${i}(${a??""})'`),r=t.Element.getAttribute(`invalid-message-${i}`);throw null!==r&&""!==r||(r=t.Element.getAttribute("invalid-message")),null!==r&&""!==r||(r=n.message),new Error(r)}}catch(n){return t.SetError(n.message),!1}}return!0}(this)}}const i=new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2});class a extends n{constructor(t){super(t),function(t){const e=t.Nodes.Container,n=t.Nodes.LastValue,r=t.Nodes.Input,a=document.createElement("div"),s=document.createElement("input"),o=document.querySelector(`label[for="${t.Id}"]`);r.classList.add("fgta5-entry-input"),r.parentNode.insertBefore(e,r),r.setAttribute("type","hidden"),a.classList.add("fgta5-entry-input-wrapper"),s.classList.add("fgta5-entry-display"),a.appendChild(s),a.appendChild(r),e.appendChild(a),e.appendChild(n);var d=t.Element.getAttribute("description");if(null!==d&&""!==d.trim()){d=d.trim();const t=document.createElement("div");t.classList.add("fgta5-entry-description"),t.innerHTML=d,e.appendChild(t)}var l=t.Element.getAttribute("precision");null!==l&&""!==l.trim()?(l=parseInt(l.trim()),(isNaN(l)||l<0)&&(l=0),s.setAttribute("precision",l)):(l=0,s.setAttribute("precision",l));r.precision=l,i.minimumFractionDigits=l,i.maximumFractionDigits=l,(null===r.value||""===r.value)&&(r.value="0");s.value=i.format(r.value),n.value=s.value,s.id=t.Id+"-display",s.min=r.min,s.max=r.max,s.minlength=r.minlength,s.maxlength=r.maxlength,s.required=r.required,s.setAttribute("style",r.getAttribute("style")||""),s.setAttribute("type","number"),s.setAttribute("fgta5-component","Numberbox"),o.setAttribute("for",s.id),s.addEventListener("focus",(function(e){!function(t){var e=t.Nodes.Display,n=t.Nodes.Input;if(t.InEditMode){e.setAttribute("type","number");var r=Number(n.value);e.value=r}}(t)})),s.addEventListener("blur",(function(e){!function(t){var e=t.Nodes.Display,n=t.Nodes.Input;if(t.InEditMode){var r=Number(e.value);if(isNaN(r))t.SetError("Invalid number");else{t.SetError(null),n.value=r;var a=i.format(r);e.setAttribute("type","text"),e.value=a}}}(t)})),s.addEventListener("change",(function(e){!function(t){t.Nodes.Display,t.Nodes.Input}(t)})),s.addEventListener("input",(function(t){s.value!==n.value?s.setAttribute("changed","true"):s.removeAttribute("changed")})),t.Nodes.InputWrapper=a,t.Nodes.Label=o,t.Nodes.Display=s}(this)}get Disabled(){return this.Element.disabled}set Disabled(t){this.Element.disabled=t,function(t,e){t.Nodes.Display.disabled=!!e}(this,t)}#e=!0;get InEditMode(){return this.#e}SetEditingMode(t){this.#e=t,function(t,e){var n=e?"true":"false";t.Nodes.Display.setAttribute("editmode",n),t.Nodes.Input.setAttribute("editmode",n),t.Nodes.InputWrapper.setAttribute("editmode",n),e?(t.Nodes.Input.removeAttribute("readonly"),t.Nodes.Display.removeAttribute("readonly")):(t.Nodes.Input.setAttribute("readonly","true"),t.Nodes.Display.setAttribute("readonly","true"),t.SetError(null))}(this,t)}}const s=new CustomEvent("locked"),o=new CustomEvent("unlocked");function d(t,e){var n=t.Element,r=!e;for(var i in t.Inputs){t.Inputs[i].SetEditingMode(r)}return e?(n.dispatchEvent(s),n.setAttribute("locked",e)):(n.dispatchEvent(o),n.removeAttribute("locked")),e}const l={info:"fgta5-icon-info",warning:"fgta5-icon-warning",error:"fgta5-icon-error",question:"fgta5-icon-question"};class u{Text="button";constructor(t){this.Text=t}}class c{static ButtonOkCancel=Object.freeze({ok:new u("Ok"),cancel:new u("Cancel")});static ButtonYesNo=Object.freeze({yes:new u("Yes"),no:new u("No")});static ButtonYesNoCancel=Object.freeze({yes:new u("Yes"),no:new u("No"),cancel:new u("Cancel")});static async Show(t,e){return await m(t,e)}static async Error(t){return await async function(t){return await m(t,{iconcss:"error"})}(t)}static async Info(t){return await async function(t){return await m(t,{iconcss:"info"})}(t)}static async Warning(t){return await async function(t){return await m(t,{iconcss:"warning"})}(t)}static async Confirm(t,e){return await async function(t,e){return e=void 0===e?c.ButtonOkCancel:e,await m(t,{iconcss:"question",buttons:e})}(t,e)}}async function m(t,e){void 0===e&&(e={});var n=function(t,e){const n=document.createElement("dialog");if(n.classList.add("fgta5-messagebox-dialog"),n.addEventListener("close",(t=>{n.parentNode.removeChild(n)})),e.title&&(n.divTitle=document.createElement("div"),n.divTitle.classList.add("fgta5-messagebox-title"),n.divTitle.innerHTML=e.title,n.appendChild(n.divTitle)),e.iconcss){var r=l[e.iconcss]?l[e.iconcss]:e.iconcss;n.divIcon=document.createElement("div"),n.divIcon.classList.add("fgta5-messagebox-icon"),n.divIcon.classList.add(r),n.appendChild(n.divIcon)}return n.divContent=document.createElement("div"),n.divContent.classList.add("fgta5-messagebox-content"),n.divContent.innerHTML=t,n.appendChild(n.divContent),n.divButtons=document.createElement("div"),n.divButtons.classList.add("fgta5-messagebox-buttonsbar"),n.appendChild(n.divButtons),document.body.appendChild(n),n}(t,e);return new Promise((t=>{if(e.buttons)for(const[r,i]of Object.entries(e.buttons)){const e=document.createElement("button");e.classList.add("fgta5-messagebox-button"),e.innerHTML=i.Text,e.addEventListener("click",(()=>{n.close(),t(r)})),n.divButtons.appendChild(e)}else{const e=document.createElement("button");e.classList.add("fgta5-messagebox-button"),e.innerHTML="Ok",e.addEventListener("click",(()=>{n.close(),t("ok")})),n.divButtons.appendChild(e)}n.showModal()}))}function p(){const t=document.createElement("dialog");return t.classList.add("fgta5-modal-message"),t.addEventListener("close",(e=>{t.parentNode.removeChild(t)})),document.body.appendChild(t),t.showModal(),t}var v=Object.freeze({__proto__:null,parseFunctionParam:function(t){const[e,...n]=t.split(":"),r=n.length>0?n.join(":"):null;return{fnName:e,fnParams:null!==r?isNaN(r)?r:Number(r):null}},required:function(t){return null!=t&&""!==t},minlength:function(t,e){return null==e||0===e||!(null==t||t.length<e)},maxlength:function(t,e){return null==e||0===e||!(null==t||t.length>e)},pattern:function(t,e){return!0},email:function(t,e){return/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(t)}});const f={Component:e,Form:class extends e{#r=!1;Inputs={};constructor(t){super(t),this.#i(),function(t,e){var n=document.getElementById(e);t.Id=e,t.Element=n,t.Inputs={},t.Element.addEventListener("submit",(t=>{t.preventDefault()}));for(var i=n.querySelectorAll("input"),s=0;s<i.length;s++){var o=i[s],d=o.getAttribute("fgta5-component");null!=d&&null!=o.id&&""!=o.id&&("Textbox"==d?t.Inputs[o.id]=new r(o.id):"Numberbox"==d&&(t.Inputs[o.id]=new a(o.id)))}}(this,t)}Lock(t){this.#r=d(this,t)}IsLocked(){return this.#r}Reset(){!function(t){for(var e in t.Inputs){t.Inputs[e].Reset()}}(this)}AcceptChanges(){!function(t){for(var e in t.Inputs){t.Inputs[e].AcceptChanges()}}(this)}IsChanged(){return function(t){for(var e in t.Inputs){if(t.Inputs[e].IsChanged())return!0}return!1}(this)}NewData(t){!function(t,e){for(var n in t.Inputs){var r=t.Inputs[n],i=e[r.GetBindingName()];r.NewData(i)}}(this,t)}Render(){!function(t){for(var e in t.Inputs){t.Inputs[e].bindForm(t)}t.IsLocked()?d(t,!0):d(t,!1)}(this)}Validate(){return function(t){var e=!0;for(var n in t.Inputs){var r=t.Inputs[n];e&&=r.Validate()}return e}(this)}#i(){var t=this.Element.getAttribute("locked");null==t&&(t="false"),"true"===t.toLowerCase()?this.#r=!0:this.#r=!1}},Button:class extends e{constructor(t){var e;super(t),(e=this).Element.classList.add("fgta5-button"),e.Element.setAttribute("type","button")}#a=!1;get Disabled(){return this.#a}set Disabled(t){var e;this.#a=t,e=t,this.Element.disabled=e}},Textbox:r,Numberbox:a,MessageBox:c,MessageBoxButton:u,Modal:class{static Show(t){return p()}static Mask(t){return function(t){t=void 0===t?"Please wait ...":t;const e=p();var n=document.createElement("div");n.classList.add("fgta5-modal-loadermask-msg"),e.appendChild(n);var r=document.createElement("div");r.classList.add("fgta5-modal-loadermask-msg-icon"),r.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 200 200"><radialGradient id="a11" cx=".66" fx=".66" cy=".3125" fy=".3125" gradientTransform="scale(1.5)"><stop offset="0" stop-color="#575757"></stop><stop offset=".3" stop-color="#575757" stop-opacity=".9"></stop><stop offset=".6" stop-color="#575757" stop-opacity=".6"></stop><stop offset=".8" stop-color="#575757" stop-opacity=".3"></stop><stop offset="1" stop-color="#575757" stop-opacity="0"></stop></radialGradient><circle transform-origin="center" fill="none" stroke="url(#a11)" stroke-width="30" stroke-linecap="round" stroke-dasharray="200 1000" stroke-dashoffset="0" cx="100" cy="100" r="70"><animateTransform type="rotate" attributeName="transform" calcMode="spline" dur="1.8" values="360;0" keyTimes="0;1" keySplines="0 0 1 1" repeatCount="indefinite"></animateTransform></circle><circle transform-origin="center" fill="none" opacity=".2" stroke="#575757" stroke-width="30" stroke-linecap="round" cx="100" cy="100" r="70"></circle></svg>',n.appendChild(r);var i=document.createElement("div");return i.classList.add("fgta5-modal-loadermask-msg-text"),i.innerHTML=t,n.appendChild(i),e.setText=t=>{i.innerHTML=t},e}(t)}static Progress(t){return function(t){void 0===t&&(t={});const e=p();e.IsError=!1;var n=document.createElement("div");e.appendChild(n);var r=document.createElement("div");r.classList.add("fgta5-modal-progressbar-container"),e.appendChild(r);var i=document.createElement("label");i.classList.add("fgta5-modal-progressbar"),r.appendChild(i);var a=document.createElement("div");return a.classList.add("fgta5-modal-progressbar-text"),e.appendChild(a),e.setProgress=function(t,e){t>100&&(t=100),i.innerHTML=`${t}%`,i.style.width=`${t}%`,a.innerHTML=e},e.setError=function(t){e.IsError=!0,n.classList.add("fgta5-icon-error"),n.style.height="32px",n.style.marginBottom="10px",a.innerHTML=t,a.setAttribute("error","true"),i.setAttribute("error","true")},e.finish=function(n,r){if(void 0===n&&(n="Done"),void 0===r&&(r=!0),!0===t.buttonClose||e.IsError){r&&(a.style.display="none",i.style.width="100%",i.innerHTML="100%");var s=document.createElement("div");s.style.textAlign="center",s.style.marginTop="10px",s.style.marginBottom="0";var o=document.createElement("button");o.classList.add("fgta5-modal-button"),o.innerHTML=n,o.addEventListener("click",(()=>{e.close()})),s.appendChild(o),e.appendChild(s)}else e.close()},e}(t)}}};void 0===window.$validators?window.$validators=v:Object.assign(window.$validators,v);export{f as default};
